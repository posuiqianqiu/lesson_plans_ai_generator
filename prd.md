# 教案AI生成器 MVP版本 PRD

## 1. 产品概述

### 1.1 产品名称
教案AI生成器（Lesson Plan AI Generator）

### 1.2 产品定位
面向高职院校教师的命令行工具，利用本地AI技术批量生成整学期教案，显著提升备课效率。

### 1.3 MVP核心价值
- **效率提升**：将教案编写时间从数小时缩短到几分钟
- **批量处理**：一键生成整学期所有课程教案
- **本地部署**：使用Ollama确保数据安全和隐私
- **高职适配**：针对职业技能教育特点优化内容生成

## 2. 用户画像

### 2.1 核心用户
**高职院校专业课教师**
- 年龄：30-50岁
- 技术能力：具备基本计算机操作能力，能使用命令行工具
- 痛点：
  - 每学期需要编写大量教案，重复性工作多
  - 格式要求严格，排版耗时
  - 教学内容需要符合高职教育特点

## 3. MVP功能范围

### 3.1 核心功能
| 功能模块 | 功能描述 | MVP优先级 |
|---------|---------|-----------|
| 教学数据读取 | 解析Excel教学进度表和Word教学大纲 | P0 |
| AI内容生成 | 调用本地Ollama模型生成各教案字段内容 | P0 |
| 批量文档生成 | 按周次和课次批量生成Word格式教案 | P0 |
| 命令行界面 | 提供简单易用的命令行操作界面 | P0 |

### 3.2 非MVP功能（后续版本）
- 图形化界面
- 教案质量评估
- 多学科模板库
- 历史记录管理

## 4. 用户流程

### 4.1 准备工作
```
1. 准备教学进度表（Excel格式）
2. 准备教学大纲（Word格式）  
3. 准备教案模板（Word格式）
4. 确保Ollama服务正常运行
```

### 4.2 生成流程
```bash
# 单次生成示例
python main.py -s "进度表.xlsx" -y "大纲.docx" -t "模板.docx"

# 批量生成示例  
python main.py -s "进度表.xlsx" -y "大纲.docx" -t "模板.docx" -w "1-16"
```

## 5. 技术规格

### 5.1 系统架构
```
输入层：
  ├── 教学进度表（Excel）
  ├── 教学大纲（Word）
  └── 教案模板（Word）

处理层：
  ├── 数据解析器
  ├── AI生成引擎（Ollama）
  └── 文档组装器

输出层：
  └── 批量教案文档（Word）
```

### 5.2 技术栈
- **编程语言**: Python 3.8+
- **核心依赖**:
  - `python-docx`: Word文档处理
  - `pandas`: Excel数据解析
  - `requests`: Ollama API调用
- **AI服务**: Ollama + 本地LLM（推荐qwen:7b）
- **部署方式**: 命令行工具

### 5.3 文件格式要求
#### 教学进度表（Excel）
```csv
周次,课次,课程名称,章节内容,课时
1,1,AutoCAD基础,软件界面与基本操作,2
1,2,AutoCAD基础,直线与多段线绘制,2
```

#### 教案模板（Word）
使用占位符标记需要生成的内容：
```
授课章节：{授课章节}
单元教学目标：{单元教学目标}
教学重点：{教学重点}
教学难点：{教学难点}
```

## 6. AI提示词设计

### 6.1 核心提示词原则
- **高职特色**: 强调技能培养、实操训练
- **具体明确**: 避免空泛描述，要求可操作性
- **格式统一**: 确保生成内容格式规范

### 6.2 关键字段提示词示例
```python
PROMPT_TEMPLATES = {
    "单元教学目标": """
作为高职院校{course_name}课程教师，请为第{week}周第{lesson}次课设计教学目标：
章节内容：{chapter_content}

要求：
1. 包含知识、技能、素养三个维度
2. 每条目标具体可测量
3. 突出职业技能培养
4. 格式：分条列出，每条以•开头
    """,
    
    "教学活动": """
设计一个适合高职学生的课堂活动：
课程：{course_name}
内容：{chapter_content}
课时：{class_hours}

要求：
1. 包含教师演示和学生实操环节
2. 时长约{activity_duration}分钟
3. 需要具体的操作步骤
4. 体现工学结合特点
    """
}
```

## 7. 成功指标

### 7.1 功能性指标
- ✅ 成功解析教学进度表和大纲文件
- ✅ 正确调用Ollama生成各字段内容
- ✅ 批量生成格式规范的Word教案
- ✅ 单次生成成功率 > 90%

### 7.2 用户体验指标
- ⏱️ 单份教案生成时间 < 2分钟
- 📊 整学期（16周）生成时间 < 30分钟
- 🎯 生成内容相关度 > 80%（人工评估）

## 8. 部署和运行要求

### 8.1 系统要求
- **操作系统**: Windows 10/11, macOS, Linux
- **内存**: 至少8GB RAM（运行Ollama）
- **存储**: 至少10GB可用空间
- **网络**: 可离线运行（模型已下载）

### 8.2 安装步骤
```bash
# 1. 安装Python依赖
pip install python-docx pandas requests openpyxl

# 2. 安装并配置Ollama
ollama pull qwen:7b

# 3. 运行教案生成器
python main.py -s schedule.xlsx -y syllabus.docx -t template.docx
```

#